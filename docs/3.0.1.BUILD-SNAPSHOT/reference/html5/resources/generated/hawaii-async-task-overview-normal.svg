<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2107px" preserveAspectRatio="none" style="width:2875px;height:2107px;" version="1.1" viewBox="0 0 2875 2107" width="2875px" zoomAndPan="magnify"><defs><filter height="300%" id="f19oqorm7oiqdw" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="63.832" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="37" y="61.2969"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="37" y="1259.0313"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="746.7188" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="156" y="1288.1641"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="287.9922" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="287" y="1433.8281"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="473" y="1662.6875"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="473" y="1750.9531"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="1133.9023" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="707.5" y="125.1289"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="895.375" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="938.5" y="334.5234"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="762.6797" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1146.5" y="438.0859"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="34.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1151.5" y="1063.0391"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="688.4531" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1393.5" y="1317.2969"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="431.6563" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1398.5" y="1404.6953"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="558.6875" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1532" y="467.2188"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="630.3203" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1882.5" y="1346.4297"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2061" y="620.7813"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2061" y="887.6406"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2061" y="1533.2578"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="68.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2061" y="1865.3516"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2385" y="800.2109"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="39.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2385" y="1894.4844"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="616.9531" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2571.5" y="408.9531"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="587.0547" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2571.5" y="1375.5625"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="659.4531" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2725.5" y="1317.2969"/><rect fill="#94B57E" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="67" x="1363" y="268.2266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="1370" y="288.2217">Callable</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="1989" y="342.6563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="136" x="1996" y="362.6514">SharedTaskContext</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="1796" y="529.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="165" x="1803" y="549.4795">AbortableTaskRunnable</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="146" x="2153" y="733.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="132" x="2160" y="753.9092">TimeoutGuardTask</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="2785" y="853.3389">guard-&lt;n&gt;</text><ellipse cx="2827" cy="824.3438" fill="#EEEEEE" filter="url(#f19oqorm7oiqdw)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2823,812.3438,2829,807.3438,2827,812.3438,2829,817.3438,2823,812.3438" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#EEEEEE" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="146" x="86" y="1076.1719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="132" x="93" y="1096.167">CompletableFuture</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="2686" y="1166.4639">thread-&lt;n&gt;</text><ellipse cx="2730.5" cy="1137.4688" fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2726.5,1125.4688,2732.5,1120.4688,2730.5,1125.4688,2732.5,1130.4688,2726.5,1125.4688" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="563" y="1466.9609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="570" y="1486.9561">AbortStrategy</text><rect fill="#EEEEEE" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="146" x="403" y="1596.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="132" x="410" y="1616.3857">CompletableFuture</text><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="42" x2="42" y1="51.2969" y2="2053.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="161" x2="161" y1="1108.8203" y2="2053.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="292" x2="292" y1="51.2969" y2="2053.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="478" x2="478" y1="1629.0391" y2="2053.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="619" x2="619" y1="1499.6094" y2="2053.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="712" x2="712" y1="51.2969" y2="2053.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="943.5" x2="943.5" y1="51.2969" y2="2053.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1151" x2="1151" y1="51.2969" y2="2053.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1398" x2="1398" y1="300.875" y2="2053.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1537" x2="1537" y1="51.2969" y2="2053.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1887" x2="1887" y1="562.1328" y2="2053.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2066" x2="2066" y1="375.3047" y2="2053.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2228" x2="2228" y1="766.5625" y2="2053.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2390" x2="2390" y1="51.2969" y2="2053.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2576" x2="2576" y1="51.2969" y2="2053.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2730" x2="2730" y1="1160.6172" y2="2053.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2827" x2="2827" y1="847.4922" y2="2053.0156"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="64" x="8" y="16"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="15" y="35.9951">Service</text><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="64" x="8" y="2052.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="50" x="15" y="2072.0107">Service</text><rect fill="#EEEEEE" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="146" x="86" y="2052.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="132" x="93" y="2072.0107">CompletableFuture</text><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="88" x="246" y="16"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="253" y="35.9951">Repository</text><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="88" x="246" y="2052.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="74" x="253" y="2072.0107">Repository</text><rect fill="#EEEEEE" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="146" x="403" y="2052.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="132" x="410" y="2072.0107">CompletableFuture</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="563" y="2052.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="570" y="2072.0107">AbortStrategy</text><rect fill="#94B57E" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="685" y="16"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="692" y="35.9951">Proxy</text><rect fill="#94B57E" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="51" x="685" y="2052.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="37" x="692" y="2072.0107">Proxy</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="866.5" y="16"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="136" x="873.5" y="35.9951">DelegatingExecutor</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="866.5" y="2052.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="136" x="873.5" y="2072.0107">DelegatingExecutor</text><rect fill="#94B57E" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="187" x="1056" y="16"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="173" x="1063" y="35.9951">ThreadPoolTaskExecutor</text><rect fill="#94B57E" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="187" x="1056" y="2052.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="173" x="1063" y="2072.0107">ThreadPoolTaskExecutor</text><rect fill="#94B57E" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="67" x="1363" y="2052.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="1370" y="2072.0107">Callable</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="182" x="1444" y="16"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="168" x="1451" y="35.9951">AbortableTaskDecorator</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="182" x="1444" y="2052.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="168" x="1451" y="2072.0107">AbortableTaskDecorator</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="1796" y="2052.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="165" x="1803" y="2072.0107">AbortableTaskRunnable</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="1989" y="2052.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="136" x="1996" y="2072.0107">SharedTaskContext</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="146" x="2153" y="2052.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="132" x="2160" y="2072.0107">TimeoutGuardTask</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="2313" y="16"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="136" x="2320" y="35.9951">GuardTaskExecutor</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="2313" y="2052.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="136" x="2320" y="2072.0107">GuardTaskExecutor</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="195" x="2477" y="16"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="181" x="2484" y="35.9951">SharedTaskContextHolder</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="195" x="2477" y="2052.0156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="181" x="2484" y="2072.0107">SharedTaskContextHolder</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="2686" y="2065.0107">thread-&lt;n&gt;</text><ellipse cx="2730.5" cy="2084.3125" fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2726.5,2072.3125,2732.5,2067.3125,2730.5,2072.3125,2732.5,2077.3125,2726.5,2072.3125" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="2785" y="2065.0107">guard-&lt;n&gt;</text><ellipse cx="2827" cy="2084.3125" fill="#EEEEEE" filter="url(#f19oqorm7oiqdw)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2823,2072.3125,2829,2067.3125,2827,2072.3125,2829,2077.3125,2823,2072.3125" style="stroke: #A80036; stroke-width: 1.0;"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="63.832" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="37" y="61.2969"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="37" y="1259.0313"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="746.7188" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="156" y="1288.1641"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="287.9922" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="287" y="1433.8281"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="473" y="1662.6875"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="473" y="1750.9531"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="1133.9023" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="707.5" y="125.1289"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="895.375" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="938.5" y="334.5234"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="762.6797" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1146.5" y="438.0859"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="34.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1151.5" y="1063.0391"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="688.4531" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1393.5" y="1317.2969"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="431.6563" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1398.5" y="1404.6953"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="558.6875" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1532" y="467.2188"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="630.3203" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1882.5" y="1346.4297"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2061" y="620.7813"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2061" y="887.6406"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="30" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2061" y="1533.2578"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="68.2656" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2061" y="1865.3516"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2385" y="800.2109"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="39.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2385" y="1894.4844"/><rect fill="#FFFFFF" filter="url(#f19oqorm7oiqdw)" height="616.9531" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2571.5" y="408.9531"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="587.0547" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2571.5" y="1375.5625"/><rect fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" height="659.4531" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="2725.5" y="1317.2969"/><polygon fill="#A80036" points="695.5,121.1289,705.5,125.1289,695.5,129.1289,699.5,125.1289" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="42" x2="701.5" y1="125.1289" y2="125.1289"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="49" y="120.1958">getUser()</text><path d="M722,66.2969 L722,166.2969 L1764,166.2969 L1764,76.2969 L1754,66.2969 L722,66.2969 " fill="#FBFB77" filter="url(#f19oqorm7oiqdw)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1754,66.2969 L1754,76.2969 L1764,76.2969 L1754,66.2969 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="23" x="728" y="83.3638">The</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="755" y="83.3638">Repository#getUser()</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="919" y="83.3638">method is annotation with the</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="1114" y="83.3638">@Async</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="431" x="1166" y="83.3638">annotation. The annotation may contain the Spring bean name of a</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="1601" y="83.3638">ThreadPoolExecutor</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="1745" y="83.3638">.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="368" x="728" y="98.4966">This allows looking up specific executors for specific tasks.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="732" y="113.6294"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="62" x="728" y="128.7622">Each task</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="794" y="128.7622">must</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="835" y="128.7622">be configured in order create a</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="1036" y="128.7622">DelegatingExecutor</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="426" x="1184" y="128.7622">for it. The executor is registered under the configured task's name.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="732" y="143.895"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="728" y="159.0278">In this sequence the</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="861" y="159.0278">DelegatingExecutor</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="1009" y="159.0278">is registered under the name</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="1199" y="159.0278">repo.get_user</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="717.5" x2="759.5" y1="222.2266" y2="222.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="759.5" x2="759.5" y1="222.2266" y2="235.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="718.5" x2="759.5" y1="235.2266" y2="235.2266"/><polygon fill="#A80036" points="728.5,231.2266,718.5,235.2266,728.5,239.2266,724.5,235.2266" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="724.5" y="217.1606">findExecutor( '</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="815.5" y="217.1606">repo.get_user</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="12" x="919.5" y="217.1606">' )</text><polygon fill="#A80036" points="1351,285.2266,1361,289.2266,1351,293.2266,1355,289.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="717.5" x2="1357" y1="289.2266" y2="289.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="25" x="724.5" y="284.2935">new</text><rect fill="#94B57E" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="67" x="1363" y="268.2266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="53" x="1370" y="288.2217">Callable</text><polygon fill="#A80036" points="926.5,330.5234,936.5,334.5234,926.5,338.5234,930.5,334.5234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="717.5" x2="932.5" y1="334.5234" y2="334.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="724.5" y="329.5903">execute( callable )</text><polygon fill="#A80036" points="1977,359.6563,1987,363.6563,1977,367.6563,1981,363.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="948.5" x2="1983" y1="363.6563" y2="363.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="955.5" y="358.7231">new( config, this )</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="1989" y="342.6563"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="136" x="1996" y="362.6514">SharedTaskContext</text><polygon fill="#A80036" points="2559.5,404.9531,2569.5,408.9531,2559.5,412.9531,2563.5,408.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="948.5" x2="2565.5" y1="408.9531" y2="408.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="955.5" y="404.02">register( sharedTaskContext )</text><polygon fill="#A80036" points="1134.5,434.0859,1144.5,438.0859,1134.5,442.0859,1138.5,438.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="948.5" x2="1140.5" y1="438.0859" y2="438.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="955.5" y="433.1528">execute( callable )</text><polygon fill="#A80036" points="1520,463.2188,1530,467.2188,1520,471.2188,1524,467.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1156.5" x2="1526" y1="467.2188" y2="467.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="1163.5" y="462.2856">decorate( callable )</text><polygon fill="#A80036" points="2559.5,492.3516,2569.5,496.3516,2559.5,500.3516,2563.5,496.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1542" x2="2565.5" y1="496.3516" y2="496.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="1549" y="491.4185">sharedTaskContext = get( )</text><polygon fill="#A80036" points="1784,546.4844,1794,550.4844,1784,554.4844,1788,550.4844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1542" x2="1790" y1="550.4844" y2="550.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="1549" y="545.5513">new( runnable, sharedTaskContext )</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="1796" y="529.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="165" x="1803" y="549.4795">AbortableTaskRunnable</text><polygon fill="#A80036" points="2049,616.7813,2059,620.7813,2049,624.7813,2053,620.7813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1542" x2="2055" y1="620.7813" y2="620.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="1549" y="615.8481">registerRemovalStrategy( guarded )</text><polygon fill="#A80036" points="2141,750.9141,2151,754.9141,2141,758.9141,2145,754.9141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1542" x2="2147" y1="754.9141" y2="754.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="166" x="1549" y="749.981">new( sharedTaskContext )</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="146" x="2153" y="733.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="132" x="2160" y="753.9092">TimeoutGuardTask</text><polygon fill="#A80036" points="2373,796.2109,2383,800.2109,2373,804.2109,2377,800.2109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1542" x2="2379" y1="800.2109" y2="800.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="334" x="1549" y="795.2778">schedule( guard, sharedTaskContext.getTimeout( ) )</text><polygon fill="#CCCCCC" points="2773,825.3438,2783,829.3438,2773,833.3438,2777,829.3438" style="stroke: #CCCCCC; stroke-width: 1.0;"/><line style="stroke: #CCCCCC; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="2390" x2="2779" y1="829.3438" y2="829.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="25" x="2397" y="824.4106">new</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="78" x="2785" y="853.3389">guard-&lt;n&gt;</text><ellipse cx="2827" cy="824.3438" fill="#EEEEEE" filter="url(#f19oqorm7oiqdw)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2823,812.3438,2829,807.3438,2827,812.3438,2829,817.3438,2823,812.3438" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="2049,883.6406,2059,887.6406,2049,891.6406,2053,887.6406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1542" x2="2055" y1="887.6406" y2="887.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="302" x="1549" y="882.7075">registerRemoveTimeoutGuardStrategy( guard )</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1156.5" x2="1166.5" y1="996.7734" y2="992.7734"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1156.5" x2="1166.5" y1="996.7734" y2="1000.7734"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1156.5" x2="1531" y1="996.7734" y2="996.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="1173.5" y="991.8403">abortableTaskRunnable</text><polygon fill="#A80036" points="2564.5,1021.9063,2574.5,1025.9063,2564.5,1029.9063,2568.5,1025.9063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1537" x2="2570.5" y1="1025.9063" y2="1025.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="1544" y="1020.9731">remove()</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1156.5" x2="1203.5" y1="1050.1719" y2="1050.1719"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1203.5" x2="1203.5" y1="1050.1719" y2="1063.1719"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1162.5" x2="1203.5" y1="1063.1719" y2="1063.1719"/><polygon fill="#A80036" points="1172.5,1059.1719,1162.5,1063.1719,1172.5,1067.1719,1168.5,1063.1719" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="1168.5" y="1045.106">enqueue( abortableTaskRunnable )</text><polygon fill="#A80036" points="247,1093.1719,237,1097.1719,247,1101.1719,243,1097.1719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="241" x2="1145.5" y1="1097.1719" y2="1097.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="25" x="253" y="1092.2388">new</text><rect fill="#EEEEEE" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="146" x="86" y="1076.1719"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="132" x="93" y="1096.167">CompletableFuture</text><polygon fill="#CCCCCC" points="2674,1138.4688,2684,1142.4688,2674,1146.4688,2678,1142.4688" style="stroke: #CCCCCC; stroke-width: 1.0;"/><line style="stroke: #CCCCCC; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1156.5" x2="2680" y1="1142.4688" y2="1142.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="25" x="1163.5" y="1137.5356">new</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="83" x="2686" y="1166.4639">thread-&lt;n&gt;</text><ellipse cx="2730.5" cy="1137.4688" fill="#EECCEE" filter="url(#f19oqorm7oiqdw)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><polygon fill="#A80036" points="2726.5,1125.4688,2732.5,1120.4688,2730.5,1125.4688,2732.5,1130.4688,2726.5,1125.4688" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="948.5" x2="958.5" y1="1200.7656" y2="1196.7656"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="948.5" x2="958.5" y1="1200.7656" y2="1204.7656"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="948.5" x2="1150.5" y1="1200.7656" y2="1200.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="965.5" y="1195.8325">CompletableFuture&lt;User&gt;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="717.5" x2="727.5" y1="1229.8984" y2="1225.8984"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="717.5" x2="727.5" y1="1229.8984" y2="1233.8984"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="717.5" x2="942.5" y1="1229.8984" y2="1229.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="734.5" y="1224.9653">CompletableFuture&lt;User&gt;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="47" x2="57" y1="1259.0313" y2="1255.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="47" x2="57" y1="1259.0313" y2="1263.0313"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="47" x2="711.5" y1="1259.0313" y2="1259.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="64" y="1254.0981">CompletableFuture&lt;User&gt;</text><polygon fill="#A80036" points="144,1284.1641,154,1288.1641,144,1292.1641,148,1288.1641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="42" x2="150" y1="1288.1641" y2="1288.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="49" y="1283.231">get()</text><polygon fill="#A80036" points="1381.5,1313.2969,1391.5,1317.2969,1381.5,1321.2969,1385.5,1317.2969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="166" x2="1387.5" y1="1317.2969" y2="1317.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="31" x="173" y="1312.3638">get()</text><polygon fill="#A80036" points="1903.5,1342.4297,1893.5,1346.4297,1903.5,1350.4297,1899.5,1346.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1897.5" x2="2724.5" y1="1346.4297" y2="1346.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="1909.5" y="1341.4966">run</text><polygon fill="#A80036" points="2559.5,1371.5625,2569.5,1375.5625,2559.5,1379.5625,2563.5,1375.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1892.5" x2="2565.5" y1="1375.5625" y2="1375.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="1899.5" y="1370.6294">register( sharedTaskContext )</text><polygon fill="#A80036" points="1419.5,1400.6953,1409.5,1404.6953,1419.5,1408.6953,1415.5,1404.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1413.5" x2="1881.5" y1="1404.6953" y2="1404.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="21" x="1425.5" y="1399.7622">run</text><polygon fill="#A80036" points="308,1429.8281,298,1433.8281,308,1437.8281,304,1433.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="302" x2="1397.5" y1="1433.8281" y2="1433.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="314" y="1428.895">getUser()</text><polygon fill="#A80036" points="551,1483.9609,561,1487.9609,551,1491.9609,555,1487.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="297" x2="557" y1="1487.9609" y2="1487.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="25" x="304" y="1483.0278">new</text><rect fill="#99CCFF" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="108" x="563" y="1466.9609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="94" x="570" y="1486.9561">AbortStrategy</text><polygon fill="#A80036" points="2049,1529.2578,2059,1533.2578,2049,1537.2578,2053,1533.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="297" x2="2055" y1="1533.2578" y2="1533.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="304" y="1528.3247">registerAbortStrategy( ... )</text><polygon fill="#A80036" points="391,1613.3906,401,1617.3906,391,1621.3906,395,1617.3906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="297" x2="397" y1="1617.3906" y2="1617.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="25" x="304" y="1612.4575">new</text><rect fill="#EEEEEE" filter="url(#f19oqorm7oiqdw)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="146" x="403" y="1596.3906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="132" x="410" y="1616.3857">CompletableFuture</text><polygon fill="#A80036" points="461,1658.6875,471,1662.6875,461,1666.6875,465,1662.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="297" x2="467" y1="1662.6875" y2="1662.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="304" y="1657.7544">completedFuture( User )</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1396.5" x2="1386.5" y1="1721.8203" y2="1717.8203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1396.5" x2="1386.5" y1="1721.8203" y2="1725.8203"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="292" x2="1397.5" y1="1721.8203" y2="1721.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="174" x="299" y="1716.8872">CompletableFuture&lt;User&gt;</text><polygon fill="#A80036" points="494,1746.9531,484,1750.9531,494,1754.9531,490,1750.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="488" x2="1397.5" y1="1750.9531" y2="1750.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="500" y="1746.02">get( )</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="1396.5" x2="1386.5" y1="1780.0859" y2="1776.0859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1396.5" x2="1386.5" y1="1780.0859" y2="1784.0859"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="478" x2="1397.5" y1="1780.0859" y2="1780.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="30" x="485" y="1775.1528">User</text><line style="stroke: #A80036; stroke-width: 2.0;" x1="469" x2="487" y1="1771.0859" y2="1789.0859"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="469" x2="487" y1="1789.0859" y2="1771.0859"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1408.5" x2="1450.5" y1="1809.3516" y2="1809.3516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1450.5" x2="1450.5" y1="1809.3516" y2="1822.3516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1409.5" x2="1450.5" y1="1822.3516" y2="1822.3516"/><polygon fill="#A80036" points="1419.5,1818.3516,1409.5,1822.3516,1419.5,1826.3516,1415.5,1822.3516" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="1415.5" y="1804.2856">set( User )</text><line style="stroke: #CCCCCC; stroke-width: 1.0;" x1="1880.5" x2="1870.5" y1="1836.3516" y2="1832.3516"/><line style="stroke: #CCCCCC; stroke-width: 1.0;" x1="1880.5" x2="1870.5" y1="1836.3516" y2="1840.3516"/><line style="stroke: #CCCCCC; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1403.5" x2="1881.5" y1="1836.3516" y2="1836.3516"/><polygon fill="#A80036" points="2049,1861.3516,2059,1865.3516,2049,1869.3516,2053,1865.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1892.5" x2="2055" y1="1865.3516" y2="1865.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="1899.5" y="1860.4185">finish()</text><polygon fill="#A80036" points="2373,1890.4844,2383,1894.4844,2373,1898.4844,2377,1894.4844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2071" x2="2379" y1="1894.4844" y2="1894.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="2078" y="1889.5513">remove( TimeoutGuardTask )</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="2228" x2="2238" y1="1933.6172" y2="1929.6172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2228" x2="2238" y1="1933.6172" y2="1937.6172"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2228" x2="2389" y1="1933.6172" y2="1933.6172"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="2219" x2="2237" y1="1924.6172" y2="1942.6172"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="2219" x2="2237" y1="1942.6172" y2="1924.6172"/><polygon fill="#A80036" points="2564.5,1958.6172,2574.5,1962.6172,2564.5,1966.6172,2568.5,1962.6172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1892.5" x2="2570.5" y1="1962.6172" y2="1962.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="1899.5" y="1957.6841">remove()</text><line style="stroke: #CCCCCC; stroke-width: 1.0;" x1="2728.5" x2="2718.5" y1="1976.75" y2="1972.75"/><line style="stroke: #CCCCCC; stroke-width: 1.0;" x1="2728.5" x2="2718.5" y1="1976.75" y2="1980.75"/><line style="stroke: #CCCCCC; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="1887.5" x2="2729.5" y1="1976.75" y2="1976.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="166" x2="176" y1="2005.75" y2="2001.75"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="166" x2="176" y1="2005.75" y2="2009.75"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="166" x2="1397.5" y1="2005.75" y2="2005.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="30" x="183" y="2000.8169">User</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="42" x2="52" y1="2034.8828" y2="2030.8828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="42" x2="52" y1="2034.8828" y2="2038.8828"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="42" x2="160" y1="2034.8828" y2="2034.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="30" x="59" y="2029.9497">User</text><!--
@startuml

participant svc as "Service" #fff
participant future as "CompletableFuture" #eee
participant repo as "Repository" #fff
participant future_2 as "CompletableFuture" #eee
participant abort as "AbortStrategy" #99ccff
participant proxy as "Proxy" #94b57e
participant delegating_exec as "DelegatingExecutor" #99ccff
participant executor as "ThreadPoolTaskExecutor" #94b57e
participant callable as "Callable" #94b57e

participant decorator as "AbortableTaskDecorator" #99ccff
participant guarded as "AbortableTaskRunnable" #99ccff
participant shared as "SharedTaskContext" #99ccff
participant guard as "TimeoutGuardTask" #99ccff
participant guard_executor as "GuardTaskExecutor" #99ccff
participant thread_local as "SharedTaskContextHolder" #99ccff

control thread as "thread-<n>" #ece

control guard_thread as "guard-<n>" #eee

activate svc
  svc -> proxy : getUser()
deactivate svc
note right
  The ""Repository#getUser()"" method is annotation with the ""@Async"" annotation. The annotation may contain the Spring bean name of a ""ThreadPoolExecutor"".
  This allows looking up specific executors for specific tasks.

  Each task **must** be configured in order create a ""DelegatingExecutor"" for it. The executor is registered under the configured task's name.

  In this sequence the ""DelegatingExecutor"" is registered under the name ""repo.get_user""
end note
|||
activate proxy

  proxy -> proxy : findExecutor( '""repo.get_user""' )
  |||

  create callable
  proxy -> callable : new
  proxy -> delegating_exec : execute( callable )

  activate delegating_exec
    create shared
    delegating_exec -> shared : new( config, this )

    delegating_exec -> thread_local : register( sharedTaskContext )
    activate thread_local

    delegating_exec -> executor : execute( callable )
    activate executor
      executor -> decorator : decorate( callable )
      activate decorator
        decorator -> thread_local : sharedTaskContext = get( )
        |||
        create guarded
        decorator -> guarded : new( runnable, sharedTaskContext )

        |||
        decorator -> shared : registerRemovalStrategy( guarded )
        activate shared
        deactivate shared
        |||
        |||
        |||

        create guard
        decorator -> guard : new( sharedTaskContext )
        decorator -> guard_executor : schedule( guard, sharedTaskContext.getTimeout( ) )
        activate guard_executor
          create guard_thread
          guard_executor -[#ccc]-> guard_thread : new
        deactivate guard_executor
        decorator -> shared : registerRemoveTimeoutGuardStrategy( guard )
        activate shared
        deactivate shared
        |||
        |||

        decorator - ->> executor : abortableTaskRunnable

        decorator -> thread_local : remove()
        deactivate thread_local
      deactivate decorator

      executor -> executor : enqueue( abortableTaskRunnable )
      activate executor
        create future
        executor -> future : new
      deactivate executor

      create thread
      executor -[#ccc]-> thread : new



      executor - ->> delegating_exec : CompletableFuture<User>
    deactivate executor
    delegating_exec - ->> proxy : CompletableFuture<User>
  deactivate delegating_exec
  proxy - ->> svc : CompletableFuture<User>
deactivate proxy

activate svc
  svc -> future : get()
deactivate svc

activate future
  future -> callable : get()
  activate callable

activate thread #ece
  thread -> guarded : run
  activate guarded #ece
    guarded -> thread_local : register( sharedTaskContext )
    activate thread_local #ece

    guarded -> callable : run
    activate callable #ece
      callable -> repo : getUser()

      activate repo #ece
        |||
        create abort
        repo -> abort : new
        repo -> shared : registerAbortStrategy( ... )
        activate shared #ece
        deactivate shared
        |||
        create future_2
        repo -> future_2 : new
        repo -> future_2 : completedFuture( User )
        activate future_2 #ece
        deactivate future_2
        repo - ->> callable : CompletableFuture<User>
      deactivate repo
      callable -> future_2 : get( )
      activate future_2 #ece
        future_2 - ->> callable : User
      deactivate future_2
      destroy future_2
      callable -> callable : set( User )
      callable -[#ccc]->> guarded
    deactivate callable

    guarded -> shared : finish()
    activate shared #ece
      shared -> guard_executor : remove( TimeoutGuardTask )
      activate guard_executor #ece
        |||
        guard_executor ->> guard
        destroy guard
      deactivate guard_executor
    deactivate shared
    guarded -> thread_local : remove()
    deactivate thread_local
    guarded -[#ccc]->> thread
  deactivate guarded
deactivate thread

    callable - ->> future : User
  deactivate callable

  future - ->> svc : User
deactivate future
@enduml

PlantUML version 1.2018.01(Sun Jan 28 18:08:22 UTC 2018)
(APACHE source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 11.0.1+13-LTS
Operating System: Linux
OS Version: 4.14.12-041412-generic
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>